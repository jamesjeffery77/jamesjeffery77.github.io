<!DOCTYPE html>

<!-- Richard Davies, Data Science 2021 -->


<!-- ///////////////////  HEAD //////////////////////////////////// -->

<head>
<!--The next three lines allow the Vega embed-->
<script src="https://cdn.jsdelivr.net/npm/vega@5.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.12.2"></script>

<!-- This line will change the appearance of the page-->
<link href="style.css" rel="stylesheet">

<!-- This line will change the font of the page -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Lora&display=swap');
</style>

<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap');
</style>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans&family=Roboto:wght@300;700&display=swap');
</style>    

<!-- Meta stuff-->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>

<!-- ///////////////////  HEAD //////////////////////////////////// -->



<!-- ///////////////////  START BODY //////////////////////////////////// -->

<body>

    <div class="header">
        <h2><span style="color:rgb(203, 228, 50)">Data</span><span style="color:rgb(38, 52, 9)">Science</span></h2>
    </div>

    <div class="containerbutton">
        <button class="button4" onclick="window.location.href = 'portfolio'">Portfolio</button>
        <button class="button5" onclick="location.href = 'https://github.com/jamesjeffery77/jamesjeffery77.github.io'">GitHub</button>
    </div>

    <div class="containertext">
        <h3> Should we care about reducing the carbon intensity of electricity? </h3>
    </div>


    <div class="containertext">
        <h4> Project Aims</h4>
    </div>

    <div class="containertext">
        <p> We need electricity. We also need clean air to breathe. Unfortunately, electricity generation has historically been primarily generated from fossil fuels, resulting in trillions of tonnes of CO2 in our atmosphere. This is the carbon intensity of electricity – the amount of CO2 produced per unit of electricity generated. In an attempt to minimize this, most nations have made serious efforts to adopt renewable technologies to ‘decarbonize’ their electricity mix. This project aims to give an overview of the causes behind this decision, the impacts of this, and ways in which this can be improved.  </p>
   </div>

    <div class="containertext">
        <h4> Background</h4>
    </div>
   
        <div class="containertext">
    <div class="container">
        
        <!--chart1 - data was scraped from wikipedia-->
        <div class="chart" id="chart1">
            <script>
                var myChart1 = "week7/CO2EmissionValue.json";
                vegaEmbed('#chart1', myChart1);
            </script>
        </div>
    </div>

    <div class="containertext">
         <p> This chart highlights the rationale behind this movement towards renewable energy. It shows the relative CO2 emissions per KWH for common fuel sources alongside a colour-coded scale highlighting their average overnight cost per KW. The underlying CO2 emission data was scraped from wikipedia 
         <a href="https://colab.research.google.com/drive/16aHZkh8x-naBla_2HpbDb4iCDnaBD0Bn?usp=sharing"> here</a> since it was in an easier-to-scrape format than the underlying paper (PDF). The cost data was split between two webpages, which I manually added to the dataframe.</p>
    </div>

    <div class="container">
        <!--chart2 - data found from worldindata.org-->
        <div class="chart" id="chart2">
            <script>
                var myChart2 = "ElectricitySourcePercentage.json";
                vegaEmbed('#chart2', myChart2);
            </script>
        </div>
    </div>


    <div class="containertext">
    <p> This chart shows how the electricity mix in the UK has changed over time, highlighting the UK's progress. The underlying data was accessed <a href="https://ourworldindata.org/electricity-mix"> here </a> and was cleaned <a href="https://colab.research.google.com/drive/1zm4tzELSEP1y8Su3Jd9GcY8SlOpttnZB?usp=sharing"> here </a>. The cleaning process involved filtering out data from unwanted countries,  and switching the data from wide to long format which could be read by vega-lite. This data can be replicated for any country within this dataset if you input its country code in the script.</p>
    </div>

    <div class="container">
      <!--chart3 - data found from worldindata.org-->
        <div class="chart" id="chart3">
            <script>
                var myChart3 = "world_map_slider.json";
                vegaEmbed('#chart3', myChart3);
            </script>
        </div>
    </div>

    <div class="containertext">
    <p> This chart depicts the same information from the previous chart for each country in this map, with a slider highlighting the data for each year. It highlights the general worldwide movement towards a renewable energy mix, and uses the same raw data as chart two. The <a href="https://colab.research.google.com/drive/1lJEu4UEeYKpb5ncgoBZZjZlXDc3TAVW-?usp=sharing"> cleaning </a> process involved manually changing some country names in the data to match the topojson country names (i.e US to USA). I joined the data directly in Vega, where I performed a lookup transform on the fields I wanted in my final data, and filtered by year to create the slider. Data from most of Africa was only available from 2000. Sub-saharan Africa has very green electricity mix, I assume because their electriciy demand is significantly lower than in more developed countries.</p>
    </div>

    <h4> The impact of a reduction in carbon intensity </h4>
    
    <div class="container">
        <!--chart4 - regression was performed in python, data sourced from the World Bank and OurWorldInData-->
        <div class="chart" id="chart4">
            <script>
                var myChart4 = "airqualityregression.json";
                vegaEmbed('#chart4', myChart4);
            </script>
        </div>
    </div>

    <div class="containertext">
        <p> First I have regressed the percentage of electricity generated by renewables on air quality in the top 50 countries by GDP. We can see evidence of a negative correlation between the concentration of fine particle matter in the air and that country's relative carbon intensity. The underlying air quality<a href="https://www.who.int/data/gho/data/indicators/indicator-details/GHO/concentrations-of-fine-particulate-matter-(pm2-5)"> data </a> is from the WHO and the carbon intensity data is the same as before. The<a href="https://colab.research.google.com/drive/1cUk_4k3Z0YUN7Cy4X9QnGYCOtAeAXNeW?usp=sharing"> cleaning </a> process involved filtering out unwanted data, scraping the top 50 countries, and merging the two dataframes</p>
    </div>

    <div class="container">
        <!--chart5 - regression was performed in python, data sourced from the World Bank and OurWorldInData-->
        <div class="chart" id="chart5">
            <script>
                var myChart5 = "UK_regression.json";
                vegaEmbed('#chart5', myChart5);
            </script>
        </div>
    </div>

    <div class="containertext">
    <p> Unsurprisingly, in the Uk, an increase in the percentage of 
    electricity generated from renewable sources is correlated with a reduction in CO2
      emissions per capita. Data was cleaned and regression performed 
       <a href="https://colab.research.google.com/drive/1qqItkPgBbo1VeAcfCsNuZBVu346cPgIE?usp=sharing"> here </a> </p>
    </div>

    <div class="container">
        <!--chart6 - data from BEIS and OurWorldInData-->
        <div class="chart" id="chart6">
            <script>
                var myChart6 = "emissions_reduction.json";
                vegaEmbed('#chart6', myChart6);
            </script>
        </div>
    </div>

    <div class="containertext">
    <p> This chart shows how emissions have changed in the UK since 1985. The
    green wedge shows the fall in emissions seen by the UK, a fall of 31%. To identfy
    how much of this can be attributed to a greener electricity mix, I have calculated
        what emissions would have been if they grew at a steady rate alongside the 
        population, keeping the percentage of electricity generated by renewables fixed
        at the 1985 percentage. The red triangle shows the reduction in emissions that
        can be attributed to an increase in renewable energy, and the orange section shows all other factors (i.e the reduction in energy production and consumption). Its 
        effect is only really seen from 2010 onwards. In 2018, roughly 31% of the reduction
        in emissions could be attributed to greener electricity production. Data was cleaned and projection was performed <a href="https://colab.research.google.com/drive/1HO5DBj1ahQVeElNJRln8o-ZMsMLFQa-s?usp=sharing"> here </a> </p>
    </div>
    
    <h4> An easy way to help</h4>
    <div class="chart" id="firstChart"></div>
    <!-- to fetch info between dates, the api had this url https://api.carbonintensity.org.uk/intensity/YYYY-MM-DDT12:00Z(firstdate)/seconddate, 
which meant it wouldn't autoupdate-->
    <!--I wanted to autoupdate the api dates for two days before and after todays date in vega, but since the api would only fetch data for manually inputted dates, 
 I did it in javascript instead.-->
    <!--var url inputs todays date - 2 days (had to convert to miliseconds), then added 'T12:00Z' so it would be compatible with the API, 
and then plus two days (same method), and appends this to the base url-->
    <!--Then input that url into the vega data. Thanks to denes who helped make a version (dynamic_embed.html) which I changed to suit my needs better-->
<script>
    var url = 'https://api.carbonintensity.org.uk/intensity/' + new Date(Date.now()- 2 * 24 * 60 * 60 * 1000).toISOString().slice(0, 10) + 'T12:00Z/' + new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString().slice(0, 10) + 'T12:00Z';
    console.log(url)

    var spec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
   "description": "An API which shows actual carbon intensity of the UK National Grid compared to their forecast. Date autoupdating in javascript",
  "title": {
    "text": "Carbon Intensity in the UK",
    "subtitle": [
      "A forecast of future carbon intensity mapped onto past values.",
      "API from carbonintensity.org.uk"
    ],
    "subtitleFontStyle": "italic",
    "subtitleFontSize": 11,
    "anchor": "start",
    "color": "black"
  },
  "data": {
    "url": url,
    "format": {"property": "data"}
  },
  "width": 290,
  "height": 300,
    "background": null,
  "config": {"style": {"cell": {"stroke": "transparent"}}},
  "layer": [
    {
      "mark": {
        "type": "point",
        "fill": "crimson",
        "color": "crimson",
        "size": 2
      },
      "encoding": {
        "x": {"field": "to", 
        "type": "temporal",
        "scale": {"type": "utc"},
        "axis": {"format": "%b %e"}
        },
        "y": {
          "field": "intensity.actual", "type": "quantitative",
                    "title": "Carbon Intensity"
          }
      }
    },
    {
      "mark": {
        "type": "line", 
      "color": "#1fd2ff",
      "opacity" :"0.7"
      },
      "encoding": {
        "x": {
          "field": "to", 
          "type": "temporal",
          "title":null},
        "y": {
          "field": "intensity.forecast", "type": "quantitative"
          }
      }
    }
  ]
}
    vegaEmbed('#firstChart', spec)
</script>

    <div class="containertext">
        <p> This chart shows an API developed by <a href="https://carbonintensity.org.uk/"> carbonintensity.org. </a> who have developed a machine learning tool that predicts the carbon intensity of the national grid. We are currently unable to store electricity in large quantities; as a wind turbine spins it generates electricity, but when it stops, the flow does too. When demand for electricity outstrips the amount being produced renewably, then the National Grid has to use other energy which can be stored (fossil fuels) to match this demand. By using electricity at times when demand is low, then we can reduce the amount of fossil fuels needed to supplement electricity generation. We can see regular dips in the carbon intensity during the night, if we use electricity then, we are doing our bit easily! Given that this is an API, there was no need to clean the data and it can be easily replicated.  </p>
    </div>
    <h4> Conclusions</h4>
    <p> Improving carbon intensity is an important goal with numerous beneficial effects on the UK. Further work can be done to use the carbon intensity API with specific companies / institutions to identify when might be a good time to run electricity intensive processes. </p>



</body>
<!-- ///////////////////  END BODY //////////////////////////////////// -->

</html>
